!function(e){var t={};function i(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=0)}([function(e,t,i){e.exports=i(1)},function(e,t,i){"use strict";function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function r(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}i.r(t);var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),r(this,"x",void 0),r(this,"y",void 0),r(this,"div",void 0),r(this,"isAdded",!1),r(this,"isCompleted",!1),r(this,"cssStyle",void 0),r(this,"type",0),r(this,"_width",void 0),r(this,"_height",void 0),this.div=document.createElement("div"),this.initStyle(),this.initComplete()}var t,i,o;return t=e,(i=[{key:"initStyle",value:function(){}},{key:"initComplete",value:function(){this.isCompleted=!0}},{key:"update",value:function(e){}},{key:"dispose",value:function(){this.div=null}},{key:"drawCall",value:function(){this.isAdded&&this.isCompleted&&(this.div.style="transform: matrix(1,0,0,1,".concat(this.x,",").concat(this.y,");"))}},{key:"addToStage",value:function(){this.isAdded=!0,this.drawCall()}},{key:"removeToStage",value:function(){this.isAdded=!1}},{key:"width",get:function(){if(!this._width){this.cssStyle||(this.cssStyle=window.getComputedStyle(this.div));var e=this.cssStyle.getPropertyValue("width");e&&(this._width=e.slice(0,e.length-2))}return this._width||0}},{key:"height",get:function(){if(!this._height){this.cssStyle||(this.cssStyle=window.getComputedStyle(this.div));var e=this.cssStyle.getPropertyValue("height");e&&(this._height=e.slice(0,e.length-2))}return this._height||0}}])&&n(t.prototype,i),o&&n(t,o),e}();function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}r(o,"TYPE",{CIRCLE:"CIRCLE",REACTANGE:"REACTANGE",BUBBLE:"BUBBLE"});var h=function(e){function t(e){var i,n,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,r=c(t).call(this),i=!r||"object"!==l(r)&&"function"!=typeof r?s(n):r,f(s(i),"children",[]),f(s(i),"fps",1e3/45),f(s(i),"delta",0),f(s(i),"prevtime",0),i.prevtime=Date.now(),setInterval((function(){i.render()}),i.fps),i}var i,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(t,e),i=t,(n=[{key:"render",value:function(){var e=this,t=Date.now();this.delta=t-this.prevtime,this.prevtime=t,this.children.forEach((function(t){t.update(e.delta),t.drawCall()}))}},{key:"initStyle",value:function(){this.div.id="Stage"}},{key:"initComplete",value:function(){document.body.appendChild(this.div)}},{key:"addChild",value:function(e){this.children.includes(e)||(this.div.appendChild(e.div),this.children.push(e),e.addToStage())}},{key:"removeChild",value:function(e){this.children.includes(e)&&(this.div.removeChild(e.div),this.children.splice(this.children.indexOf(e),1),e.removeToStage())}}])&&u(i.prototype,n),r&&u(i,r),t}(o);function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function v(e,t,i){return(v="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,i){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=b(e)););return e}(e,t);if(n){var r=Object.getOwnPropertyDescriptor(n,t);return r.get?r.get.call(i):r.value}})(e,t,i||e)}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function g(e,t){return(g=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function m(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var w=function(e){function t(){var e,i,n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),i=this,e=!(n=b(t).call(this))||"object"!==d(n)&&"function"!=typeof n?y(i):n,m(y(e),"ms_donw_flag",!1),m(y(e),"shoot_space",100),m(y(e),"shoot_speed",500),m(y(e),"process_time",0),e.type=o.TYPE.REACTANGE,e.listener(),e}var i,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&g(e,t)}(t,e),i=t,(n=[{key:"listener",value:function(){var e=this;this.div.onmousedown=function(t){e.ms_donw_flag=!0},document.body.onmousemove=function(t){if(e.ms_donw_flag){var i=t.screenX-e.width/2;i>K.width-e.width&&(i=K.width-e.width),i<0&&(i=0),e.x=i}},document.body.onmouseup=function(t){e.ms_donw_flag=!1}}},{key:"removeList",value:function(){this.div.onmousedown=null,document.body.onmousemove=null,document.body.onmouseup=null}},{key:"update",value:function(e){var t=this.shoot_speed*e/1e3;this.process_time+=t,this.process_time>=this.shoot_space&&(this.process_time-=this.shoot_space,z.shoot())}},{key:"dispose",value:function(){v(b(t.prototype),"dispose",this).call(this),this.removeList()}},{key:"drawCall",value:function(){this.isAdded&&this.isCompleted&&z&&(v(b(t.prototype),"drawCall",this).call(this),this.div.innerHTML="".concat(z.rect_life))}},{key:"initStyle",value:function(){this.div.id="Rectangle"}}])&&p(i.prototype,n),r&&p(i,r),t}(o);function O(e){return(O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function C(e){return(C=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function k(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function P(e,t){return(P=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var S=function(e){function t(){var e,i,n,r,l,u;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),i=this,e=!(n=C(t).call(this))||"object"!==O(n)&&"function"!=typeof n?k(i):n,r=k(e),u=1,(l="speedY")in r?Object.defineProperty(r,l,{value:u,enumerable:!0,configurable:!0,writable:!0}):r[l]=u,e.type=o.TYPE.BUBBLE,e}var i,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&P(e,t)}(t,e),i=t,(n=[{key:"update",value:function(e){var t=e*this.speedY*-1,i=this.y+t;i<0&&(K.removeChild(this),z.pool.resetBullet(this)),this.y=i,z.hitCheck(this)}},{key:"initStyle",value:function(){this.div.id="Bullet"}}])&&_(i.prototype,n),r&&_(i,r),t}(o);function j(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function E(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var T=function e(t,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,r=arguments.length>3?arguments[3]:void 0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;j(this,e),E(this,"speedX",0),E(this,"speedY",0),E(this,"gravity",0),E(this,"life",1),E(this,"bounce",1e3),this.speedX=t,this.speedY=i,this.gravity=n,this.life=r,this.bounce=o};function x(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function B(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var R=function(){var e,t,i;function n(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),B(this,"levelCfg",new Map),this.levelCfg.set(1,new T(120,-130,.2,1,13)),this.levelCfg.set(2,new T(120,-130,.2,3,16)),this.levelCfg.set(3,new T(120,-130,.2,5,20)),this.levelCfg.set(4,new T(120,-130,.2,8,30)),this.levelCfg.set(5,new T(120,-130,.2,12,40))}return e=n,i=[{key:"inst",value:function(){return n.instance||(n.instance=new n),n.instance}}],(t=null)&&x(e.prototype,t),i&&x(e,i),n}();function L(e){return(L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function M(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function V(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function A(e,t,i){return(A="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,i){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=I(e)););return e}(e,t);if(n){var r=Object.getOwnPropertyDescriptor(n,t);return r.get?r.get.call(i):r.value}})(e,t,i||e)}function I(e){return(I=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Y(e,t){return(Y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function D(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}B(R,"instance",void 0);var H=function(e){function t(e,i){var n,r,l;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,n=!(l=I(t).call(this))||"object"!==L(l)&&"function"!=typeof l?V(r):l,D(V(n),"level",1),D(V(n),"circleVO",void 0),D(V(n),"up",!1),D(V(n),"gravity",0),D(V(n),"bounce",0),n.type=o.TYPE.CIRCLE,n.level=e||1,n.reset(e,i),n}var i,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Y(e,t)}(t,e),i=t,(n=[{key:"reset",value:function(e,t){this.level=e;var i=R.inst().levelCfg.get(this.level);this.circleVO=Object.assign({},i),this.circleVO.speedX*=t,this.initStyle()}},{key:"initStyle",value:function(){this.isCompleted&&(this.div.classList=["level".concat(this.level)],this.div.id="Circle")}},{key:"update",value:function(e){var t=this.circleVO.speedX*e/1e3,i=this.circleVO.speedY*e/1e3;this.up?(this.bounce*=.9,i+=-1*this.bounce,this.bounce<.5&&(this.up=!1)):(this.gravity+=this.circleVO.gravity,i+=this.gravity);var n=this.x+t,r=this.y+i;this.collisionBottom(r)&&!this.up&&(this.up=!0,this.bounce=this.circleVO.bounce,this.gravity=0),this.collisionSide(n)&&(this.circleVO.speedX*=-1,n>K.width-this.width/2&&(n=K.width-this.width/2),n<this.width/2&&(n=this.width/2)),this.x=n,this.y=r;var o=parseInt(z.rectangle.width/2);z.mesualDist(this,z.rectangle)<o&&z.catLife()}},{key:"collisionBottom",value:function(e){return e+this.width/2>K.height}},{key:"collisionSide",value:function(e){return e<this.width/2||e>K.width-this.width/2}},{key:"drawCall",value:function(){this.isAdded&&this.isCompleted&&(A(I(t.prototype),"drawCall",this).call(this),this.div.innerHTML="".concat(this.circleVO.life))}},{key:"hit",value:function(){this.circleVO.life>1?this.circleVO.life--:this.level>1?this.spit():this.die()}},{key:"spit",value:function(){var e=z.pool.getCircle(this.level-1,1),t=z.pool.getCircle(this.level-1,-1);e.x=t.x=this.x,e.y=t.y=this.y,z.addCircle(e),z.addCircle(t),this.die()}},{key:"die",value:function(){z.addResult(),z.removeCircle(this)}}])&&M(i.prototype,n),r&&M(i,r),t}(o);function X(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function G(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var N=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),G(this,"bulletPool",[]),G(this,"circlePool",[]),this.initPool()}var t,i,n;return t=e,(i=[{key:"initPool",value:function(){for(var e=0;e<30;e++){var t=new S;this.bulletPool.push(t)}for(e=0;e<50;e++){var i=new H(1,1);this.circlePool.push(i)}}},{key:"getCircle",value:function(e,t){var i;return(i=this.circlePool.length>0?this.circlePool.shift():new H(1,1)).reset(e,t),i}},{key:"resetBullet",value:function(e){this.circlePool.push(e)}},{key:"getBullet",value:function(){return this.bulletPool.length>0?this.bulletPool.shift():new S}},{key:"resetBullet",value:function(e){this.bulletPool.push(e)}}])&&X(t.prototype,i),n&&X(t,n),e}();function U(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function q(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var z,F,J,K,Q,W,Z=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),q(this,"stage",void 0),q(this,"pool",void 0),q(this,"rectangle",void 0),q(this,"circles",[]),q(this,"rect_life",5),q(this,"game_result",0),this.stage=new h,this.pool=new N}var t,i,n;return t=e,(i=[{key:"gameStop",value:function(){this.stage.removeChild(this.rectangle),this.clearCircle(),$()}},{key:"gameStart",value:function(){var e=this.pool.getCircle(4,1),t=this.pool.getCircle(5,-1);this.rectangle||(this.rectangle=new w),this.addCircle(e),this.addCircle(t),this.stage.addChild(this.rectangle),e.x=200,e.y=100,t.x=500,t.y=100,this.rectangle.x=this.stage.width-this.rectangle.width>>1,this.rectangle.y=this.stage.height-this.rectangle.height}},{key:"addCircle",value:function(e){this.circles.includes(e)||this.circles.push(e),this.stage.addChild(e)}},{key:"removeCircle",value:function(e){this.stage.removeChild(e);var t=this.circles.indexOf(e);t>-1&&this.circles.splice(t,1),0==this.circles.length&&this.rect_life>0&&this.win()}},{key:"shoot",value:function(){var e=this.pool.getBullet();e.x=this.rectangle.x+this.rectangle.width/2,e.y=this.rectangle.y,this.stage.addChild(e)}},{key:"hitCheck",value:function(e){var t=this;this.circles.forEach((function(i){var n=parseInt(i.width/2)+parseInt(e.width/2);t.mesualDist(i,e)<n&&(t.hitCircle(e,i),i.hit())}))}},{key:"mesualDist",value:function(e,t){var i=t.x-e.x,n=t.y-e.y;return Math.sqrt(i*i+n*n)}},{key:"hitCircle",value:function(e,t){this.stage.removeChild(e),this.pool.resetBullet(e),console.log("hit circle")}},{key:"clearCircle",value:function(){var e=this;this.circles.concat().forEach((function(t){e.removeCircle(t)}))}},{key:"setLife",value:function(e){this.rect_life=e,ne(this.rect_life)}},{key:"setResult",value:function(e){this.game_result=e,re(this.game_result)}},{key:"addResult",value:function(){this.game_result+=1,re(this.game_result)}},{key:"win",value:function(){te(),this.stage.removeChild(this.rectangle)}},{key:"gameOver",value:function(){ie(),this.clearCircle(),this.stage.removeChild(this.rectangle)}},{key:"catLife",value:function(){this.rect_life=Math.max(0,this.rect_life-1),ne(this.rect_life),0==this.rect_life&&this.gameOver()}}])&&U(t.prototype,i),n&&U(t,n),e}();function $(){F&&(F.style="display:block")}function ee(){F&&(F.style="display:none")}function te(){$(),J&&(J.innerHTML="恭喜游戏胜利")}function ie(){$(),J&&(J.innerHTML="!闯关失败 凸-_-凸!")}function ne(e){Q||(Q=document.getElementById("span_life")),Q.innerHTML=e}function re(e){W||(W=document.getElementById("span_result")),W.innerHTML=e}i.d(t,"game",(function(){return z})),i.d(t,"tip",(function(){return F})),i.d(t,"tipContent",(function(){return J})),i.d(t,"stage",(function(){return K})),i.d(t,"span_life",(function(){return Q})),i.d(t,"span_result",(function(){return W})),i.d(t,"openTip",(function(){return $})),i.d(t,"closeTip",(function(){return ee})),i.d(t,"win",(function(){return te})),i.d(t,"over",(function(){return ie})),i.d(t,"setLife",(function(){return ne})),i.d(t,"setResult",(function(){return re})),window.onload=function(){z=new Z,K=z.stage,J=document.getElementById("tipContent"),F=document.getElementById("tip"),document.getElementById("btn_start").onclick=function(){z.gameStart(),z.setLife(5),z.setResult(0),ee()}};t.default={game:z,tip:F,tipContent:J,stage:K}}]);